var u_titleCache='';var u_contentCache='';$('#addUnit-form')['on']('hidden.bs.modal',function(){$(this)['find']('.form-control')['val']('');});function validate_img(_0xbe0a32){var _0x41a578=_0xbe0a32['value'];if(!/.(gif|jpg|jpeg|png|GIF|JPG|bmp)$/['test'](_0x41a578)){layer['msg']('图片类型必须是.gif,jpeg,jpg,png,bmp中的一种',{'icon':0x2});return![];}else{if(_0xbe0a32['files'][0x0]['size']['toFixed'](0x2)>=0x2*0x400*0x400){layer['msg']('请上传小于2M的图片',{'icon':0x2});return![];}}return!![];}$('.unit-img')['click'](function(){$('#imgShow')['find']('img')['attr']('src',$(this)['attr']('src'));$('#imgShow')['modal']('show');});$('.unit-item')['hover'](function(){$(this)['children']('.unit-btns')['animate']({'opacity':'1'});},function(){$(this)['children']('.unit-btns')['animate']({'opacity':'0'});});$('span.title-content')['focus'](function(){$(this)['siblings']('.fa-seedling')['fadeOut']()['fadeIn']();});$('span.title-content')['on']('keydown',function(_0x5d2c7b){var _0x589924=_0x5d2c7b['keyCode'];if(_0x589924===0xd){_0x5d2c7b['preventDefault']();}});$('#btn-unit-submit')['click'](function(){var _0x56eaba=new FormData($('#add-form')[0x0]);_0x56eaba['append']('u_page',$('#p_id')['text']());$['ajax']({'url':'pageEdit/addUnit','type':'POST','data':_0x56eaba,'contentType':![],'processData':![],'dataType':'json','clearForm':!![],'success':function(_0x370a64){if(_0x370a64['status']!=='0'){var _0x387eab='添加失败';if(_0x370a64['message']!=null&&_0x370a64['message']!=''){_0x387eab=_0x370a64['message'];}layer['msg'](_0x387eab,{'icon':0x2});return;}var _0x38b157=$('.modal-zone')['children']('div.unit-item')['clone'](!![]);_0x38b157['find']('.title-content')['text'](_0x56eaba['get']('u_title'));_0x38b157['find']('.unit-content')['text'](_0x56eaba['get']('u_content'));_0x38b157['find']('.u_id')['text'](_0x370a64['u_id']);if(_0x370a64['u_img']!=null&&_0x370a64['u_img']!=''){_0x38b157['find']('.unit-img')['attr']('src','/recordProject/img/'+_0x370a64['u_img']);}$('.unit-list')['append'](_0x38b157);if($('#no-result')['hasClass']('d-none')==![]){$('#no-result')['removeClass']('d-flex');$('#no-result')['addClass']('d-none');}$('#addUnit-form')['modal']('hide');layer['msg']('添加成功',{'icon':0x1});},'error':function(_0x275412,_0x331826,_0x339f2e){console['error'](_0x339f2e);layer['msg']('提交失败',{'icon':0x2});}});});$('.btn-unit-fix')['click'](function(){var _0x4f40d4=$(this)['parents']('.unit-item');u_titleCache=_0x4f40d4['find']('.title-content')['text']();u_contentCache=_0x4f40d4['find']('.unit-content')['text']();$('.textEdit')['attr']('contenteditable','false');_0x4f40d4['find']('span.textEdit')['attr']('contenteditable','true');_0x4f40d4['find']('span.title-content')['focus']()['select']();});$('.textEdit')['keydown'](function(_0x43699a){if(_0x43699a['keyCode']==0x1b){$(this)['parents']('div.unit-item')['find']('span.textEdit')['attr']('contenteditable','false');$(this)['parents']('div.unit-item')['find']('.title-content')['text'](u_titleCache);$(this)['parents']('div.unit-item')['find']('.unit-content')['text'](u_contentCache);u_titleCache='';u_contentCache='';}});$('.textEdit')['keydown'](function(_0x4aca8f){if(_0x4aca8f['ctrlKey']==!![]&&_0x4aca8f['keyCode']==0x53){var _0x312b66=$(this)['parents']('.unit-item')['find']('.textEdit');var _0x20101e=_0x312b66['filter']('.title-content');var _0x1e3df9=_0x312b66['filter']('.unit-content');var _0x10448a=$(this)['parents']('.unit-item')['find']('.u_id')['text']();event['preventDefault']();layer['confirm']('确定保存？',{'icon':0x3,'title':'确认'},function(_0x4480df){$['post']('pageEdit/editUnit',{'u_title':_0x20101e['text'](),'u_content':_0x1e3df9['text'](),'u_id':_0x10448a},function(_0x901e32){if(_0x901e32['status']!=='0'){var _0x506e6b='修改失败';if(_0x901e32['message']!=null&&_0x901e32['message']!=''){_0x506e6b=_0x901e32['message'];}layer['msg'](_0x506e6b,{'icon':0x2});return;}u_titleCache='';u_contentCache='';_0x312b66['attr']('contenteditable','false');layer['msg']('修改成功',{'icon':0x1});});layer['close'](_0x4480df);});}});$('.btn-close')['click'](function(){var _0x3b9099=$(this)['siblings']('.u_id')['text']();var _0x1558b4=$(this)['parents']('.unit-item');layer['confirm']('确定删除？',{'icon':0x3,'title':'确认'},function(_0x7469db){$['post']('pageEdit/delUnit',{'u_id':_0x3b9099},function(_0x4e0c72){if(_0x4e0c72['status']!=='0'){var _0x5a85cc='删除失败';if(_0x4e0c72['message']!=null&&_0x4e0c72['message']!=''){_0x5a85cc=_0x4e0c72['message'];}layer['msg'](_0x5a85cc,{'icon':0x2});return;}_0x1558b4['remove']();layer['msg']('删除成功',{'icon':0x1});});layer['close'](_0x7469db);});});$('.btn-unit-img')['click'](function(){var _0x53a877=$(this)['siblings']('.u_id')['text']();$('#fileUpload')['attr']('u_id',_0x53a877);$('#fileUpload')['click']();});$('#fileUpload')['change'](function(){var _0x2c2a0c=new FormData();var _0x5507c8=$(this)['attr']('u_id');if(!validate_img(this)){$(this)['val']('');$(this)['attr']('u_id','');return![];}_0x2c2a0c['append']('u_id',_0x5507c8);_0x2c2a0c['append']('u_imgFile',$(this)[0x0]['files'][0x0]);$['ajax']({'url':'pageEdit/changeImg','type':'POST','data':_0x2c2a0c,'contentType':![],'processData':![],'dataType':'json','clearForm':!![],'success':function(_0x53f377){if(_0x53f377['status']!=='0'){var _0x2c560f='修改失败';if(_0x53f377['message']!=null&&_0x53f377['message']!=''){_0x2c560f=_0x53f377['message'];}layer['msg'](_0x2c560f,{'icon':0x2});return;}$('.u_id:contains('+_0x5507c8+')')['parents']('.unit-item')['find']('img.unit-img')['attr']('src','/recordProject/img/'+_0x53f377['u_img']);layer['msg']('图片修改成功',{'icon':0x1});},'error':function(_0x384e8c,_0x11b987,_0x1ad3bd){layer['msg']('提交失败',{'icon':0x2});}});});